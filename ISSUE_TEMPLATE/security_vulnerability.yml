name: Security Vulnerability Report
description: Report a security vulnerability in Mycelix (will create a private advisory)
title: "[SECURITY] "
labels: ["security", "priority-critical"]
assignees: []

body:
  - type: markdown
    attributes:
      value: |
        ## Security Vulnerability Report

        **IMPORTANT PRIVACY NOTICE**

        Thank you for helping keep Mycelix and its users safe. Security is critical for a decentralized system.

        **For sensitive vulnerabilities, please consider using one of these private channels instead:**

        - **GitHub Security Advisories:** [Create a private advisory](https://github.com/Luminous-Dynamics/Mycelix/security/advisories/new)
        - **Email:** security@luminous-dynamics.org (PGP key available in SECURITY.md)

        If you choose to submit here, please be mindful that this issue may be visible to others until triaged. Avoid including exploit code or detailed attack vectors for critical vulnerabilities.

        ---

        We follow responsible disclosure practices and will:
        - Acknowledge receipt within 48 hours
        - Provide an initial assessment within 7 days
        - Keep you informed of our progress
        - Credit you in the security advisory (unless you prefer anonymity)

  - type: dropdown
    id: vulnerability-type
    attributes:
      label: Vulnerability Type
      description: What type of security vulnerability is this?
      options:
        - Byzantine Attack (Consensus manipulation, malicious node behavior)
        - Cryptographic Weakness (Key management, encryption, signing issues)
        - Privacy Leak (Data exposure, metadata leakage, correlation attacks)
        - Access Control (Authorization bypass, privilege escalation)
        - Denial of Service (Resource exhaustion, crash vectors)
        - Injection (Code injection, command injection)
        - Data Integrity (State corruption, tampering)
        - Network Security (Man-in-middle, protocol issues)
        - Supply Chain (Dependency vulnerabilities)
        - Other
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: Severity Assessment
      description: |
        How severe do you consider this vulnerability?
        Consider: exploitability, impact, and affected users.
      options:
        - Critical (Remote exploit, full system compromise, affects all users)
        - High (Significant impact, exploitable under common conditions)
        - Medium (Limited impact, requires specific conditions)
        - Low (Minimal impact, difficult to exploit)
        - Unknown (Need help assessing)
    validations:
      required: true

  - type: textarea
    id: description
    attributes:
      label: Vulnerability Description
      description: |
        Describe the vulnerability. For critical issues, you may provide a high-level description
        here and share details through a private channel.
      placeholder: |
        Provide a clear description of the vulnerability:
        - What is the security issue?
        - What component is affected?
        - What is the potential impact?
    validations:
      required: true

  - type: input
    id: affected-versions
    attributes:
      label: Affected Versions
      description: Which versions of Mycelix are affected?
      placeholder: "e.g., v0.1.0 - v0.2.3, or 'all versions' or 'main branch since commit abc123'"
    validations:
      required: true

  - type: textarea
    id: affected-components
    attributes:
      label: Affected Components
      description: List the specific components, files, or modules affected
      placeholder: |
        - Component: Core consensus module
        - Files: src/consensus/validator.rs
        - Functions: validate_block(), verify_signature()
    validations:
      required: false

  - type: textarea
    id: reproduction
    attributes:
      label: Steps to Reproduce
      description: |
        How can this vulnerability be reproduced?

        **CAUTION:** For critical vulnerabilities, consider sharing detailed reproduction steps
        through a private channel instead of here.
      placeholder: |
        For non-sensitive issues:
        1. Configure the system with...
        2. Send a request to...
        3. Observe that...

        For sensitive issues, indicate: "Details shared via [private channel]"
    validations:
      required: false

  - type: textarea
    id: proof-of-concept
    attributes:
      label: Proof of Concept
      description: |
        If you have a proof-of-concept, describe it here at a high level.

        **DO NOT include working exploit code for critical vulnerabilities.**
        Share exploits only through private channels.
      placeholder: |
        High-level description of PoC (no working exploits for critical issues)
    validations:
      required: false

  - type: textarea
    id: impact
    attributes:
      label: Impact Analysis
      description: What is the potential impact if this vulnerability is exploited?
      placeholder: |
        - Who is affected? (all users, specific configurations, node operators)
        - What data or functionality is at risk?
        - What is the worst-case scenario?
        - Are there any mitigating factors?
    validations:
      required: true

  - type: textarea
    id: suggested-fix
    attributes:
      label: Suggested Fix
      description: If you have ideas for how to fix this vulnerability, please share them
      placeholder: |
        Potential fixes or mitigations:
        - Recommended approach
        - Code changes needed
        - Configuration changes
    validations:
      required: false

  - type: textarea
    id: references
    attributes:
      label: References
      description: Any relevant references, CVEs, or related vulnerabilities
      placeholder: |
        - Related CVEs
        - Academic papers
        - Similar vulnerabilities in other projects
    validations:
      required: false

  - type: checkboxes
    id: disclosure
    attributes:
      label: Disclosure Preferences
      description: Help us understand your disclosure preferences
      options:
        - label: I agree to follow responsible disclosure practices
          required: true
        - label: I would like to be credited in the security advisory
          required: false
        - label: I have additional sensitive details to share privately
          required: false

  - type: input
    id: contact
    attributes:
      label: Secure Contact Method
      description: |
        Optional: Provide a secure way to contact you (encrypted email, Signal, etc.)
        for follow-up discussions about sensitive details.
      placeholder: "e.g., encrypted email, Signal number, or 'GitHub only'"
    validations:
      required: false

  - type: checkboxes
    id: checklist
    attributes:
      label: Checklist
      description: Please confirm the following
      options:
        - label: I have not disclosed this vulnerability publicly before reporting it here
          required: true
        - label: I have not included working exploit code for critical vulnerabilities
          required: true
        - label: I understand this issue may be converted to a private security advisory
          required: true
